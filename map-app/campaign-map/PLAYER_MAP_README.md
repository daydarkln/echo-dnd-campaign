# Карта для игроков - Руководство пользователя

## Описание

Карта для игроков - это специальный режим отображения карты кампании, который показывает только те локации и пути, которые должны быть видны игрокам. Все настройки видимости сохраняются в localStorage браузера и настраиваются мастером в режиме редактирования.

## Основные функции

### 1. Отображение локаций
- **Автоматическая фильтрация** - показываются только открытые локации
- **Группировка по регионам** - локации сгруппированы по областям карты
- **Безопасный контент** - убрана информация о луте, опасностях, ловушках

### 2. Отображение путей
- **Фильтрация по видимости** - пути показываются только между видимыми локациями
- **Основные тракты** - отображаются только основные дороги
- **Интерактивность** - клик по пути показывает информацию о маршруте

### 3. Автоматическое сохранение настроек
- Все настройки видимости сохраняются в localStorage
- При перезагрузке страницы настройки восстанавливаются
- Мастер может настроить видимость в режиме редактирования

## Как использовать

### Для игроков
1. **Открытие карты**: перейдите на вкладку "Карта для игроков" в главном меню
2. **Просмотр локаций**: карта автоматически показывает только открытые локации
3. **Навигация**: используйте мышь для перемещения и масштабирования
4. **Информация**: кликните по локации для получения детальной информации

### Для мастера (настройка видимости)
1. **Режим редактирования**: используйте основной режим карты для настройки
2. **Управление видимостью**: открывайте/скрывайте локации по необходимости
3. **Автосохранение**: настройки сохраняются автоматически в localStorage
4. **Синхронизация**: изменения сразу отражаются в карте игроков

## Просмотр карты

### Элементы интерфейса
- **Локации**: отображаются синими кружками
- **Регионы**: отображаются зелеными прямоугольниками
- **Пути**: показываются только между видимыми локациями
- **Мини-карта**: помогает ориентироваться в большом пространстве

### Интерактивность
- **Клик по локации**: открывает детальную информацию
- **Наведение на локацию**: подсвечивает связанные пути
- **Клик по пути**: показывает информацию о маршруте
- **Масштабирование**: используйте колесо мыши или элементы управления

## Технические особенности

### Фильтрация данных
- Убирается информация о луте, усилителях, ослабителях
- Скрываются теги с ключевыми словами: "лут", "сокровище", "опасность", "ловушка", "секрет"
- Оставляются только безопасные теги и названия

### Производительность
- Используется мемоизация для оптимизации рендеринга
- Стабильные функции для предотвращения бесконечных циклов
- Автоматическое обновление только при изменении данных

### Совместимость
- Работает во всех современных браузерах
- Поддерживает localStorage для сохранения настроек
- Адаптивный дизайн для разных размеров экрана

## Структура файлов

```
src/
├── components/
│   ├── PlayerMap.tsx                    # Основной компонент карты игроков
│   ├── LocationVisibilitySettings.tsx   # Настройки видимости (для мастера)
│   └── PlayerLocationDetail.tsx         # Детали локации для игроков
├── hooks/
│   └── useLocationVisibility.ts         # Хук управления видимостью
└── types.ts                             # Типы данных
```

## Настройка по умолчанию

При первом запуске:
- Все локации скрыты по умолчанию
- Мастер должен вручную открыть нужные локации
- Настройки сохраняются автоматически в localStorage

## Возможные проблемы

### Локации не отображаются
1. Проверьте, открыта ли локация в режиме редактирования
2. Убедитесь, что открыт регион, содержащий локацию
3. Проверьте консоль браузера на наличие ошибок

### Настройки не сохраняются
1. Убедитесь, что localStorage доступен в браузере
2. Проверьте, не отключены ли cookies
3. Попробуйте другой браузер

### Медленная работа
1. Уменьшите количество открытых локаций
2. Обновите страницу
3. Проверьте производительность браузера

## Поддержка

При возникновении проблем:
1. Проверьте консоль браузера (F12)
2. Убедитесь, что все файлы загружены корректно
3. Попробуйте очистить localStorage и перезагрузить страницу
4. Обратитесь к мастеру для настройки видимости локаций

## Примечания для мастера

- Настройки видимости сохраняются в localStorage браузера
- Изменения в основном режиме карты влияют на карту игроков
- Рекомендуется настроить видимость перед показом карты игрокам
- Можно использовать разные настройки в разных браузерах для разных групп 